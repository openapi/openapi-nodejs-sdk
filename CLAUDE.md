# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Development Commands

### Core Commands
- `npm test` - Run the main test suite (compiles TypeScript and runs Jest on minimal-client.test.js)
- `npm run test:all` - Run all tests with Jest configuration
- `npm run build` - Compile TypeScript to JavaScript in the `dist/` directory
- `tsc` - Direct TypeScript compilation (same as npm run build)

### Publishing Commands
- `npm run patch` - Build, bump patch version, and create git tag
- `npm run minor` - Build, bump minor version, and create git tag
- `npm run tag` - Create git tag for current npm version

## Project Architecture

This is a Node.js SDK for the OpenapiÂ® marketplace that provides two main client classes:

### Core Components

**OauthClient** (`src/index.ts:15-60`)
- Handles OAuth token management for API authentication
- Supports both test (`test.oauth.altravia.com`) and production (`oauth.altravia.com`) environments
- Methods: `createToken()`, `getTokens()`, `deleteToken()`, `getCounters()`, `getScopes()`
- Uses HTTP Basic authentication with username/API key

**Client** (`src/index.ts:62-118`)
- Generic HTTP client for making API calls using access tokens
- Supports all standard HTTP methods (GET, POST, PUT, DELETE, PATCH)
- Uses Bearer token authentication
- Generic `request()` method allows custom configurations

### Dependencies
- **axios** (^0.21.2) - HTTP client library for all API communications
- **typescript** (^4.3.4) - TypeScript compilation
- **jest** (^27.0.5) - Testing framework
- **dotenv** (^10.0.0) - Environment variable loading for tests

### Key File Structure
- `src/index.ts` - Main SDK implementation with both client classes
- `test/minimal-client.test.js` - Comprehensive test suite with mocked HTTP calls
- `examples/` - Usage examples for token generation and API calls
- `dist/` - Compiled JavaScript output (generated by TypeScript compiler)

### Testing Notes
- Tests use mocked axios instances to avoid real API calls during development
- Environment variables are loaded via dotenv for test configuration
- Integration tests are skipped by default but can be enabled with real credentials
- Test files are excluded from TypeScript compilation

### TypeScript Configuration
- Targets ES5 with CommonJS modules for broad Node.js compatibility
- Strict mode enabled with declaration file generation
- Output goes to `dist/` directory with source maps disabled